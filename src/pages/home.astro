---
import Base from '../layouts/Base.astro';
---

<Base title="Mike Vincent" description="About Mike Vincent - Software Engineer">
  <div class="bio-content" id="bio-content">
    <p>Loading...</p>
  </div>
</Base>

<script is:inline>
  function loadBio() {
    const el = document.getElementById('bio-content');
    if (!el || el.dataset.loaded) return;
    el.dataset.loaded = 'true';
    fetch('https://raw.githubusercontent.com/mike-vincent/mike-vincent/main/README.md')
      .then(r => r.text())
      .then(md => {
        // Strip emoji
        md = md.replace(/[\u{1F300}-\u{1FAD6}\u{1F600}-\u{1F64F}\u{1F680}-\u{1F6FF}\u{2600}-\u{27BF}\u{FE00}-\u{FE0F}\u{1F900}-\u{1F9FF}\u{200D}\u{20E3}\u{E0020}-\u{E007F}]/gu, '').replace(/\s{2,}/g, ' ');

        let html = md
          .replace(/^# .+\n+/, '')
          .replace(/^## (.+)$/gm, '<h3>$1</h3>')
          .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>')
          .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
          .replace(/^- (.+)$/gm, '<li>$1</li>')
          .replace(/\n\n+/g, '\n\n');
        html = html.replace(/(<li>[\s\S]*?<\/li>\n?)+/g, '<ul>$&</ul>');
        html = html.split('\n\n').map(block => {
          block = block.trim();
          if (!block || block.startsWith('<h3>') || block.startsWith('<ul>')) return block;
          return '<p>' + block + '</p>';
        }).join('\n');
        html = '<h2>Bio</h2>' + html;
        el.innerHTML = html;
      });
  }
  document.addEventListener('astro:page-load', loadBio);
  loadBio();
</script>

<style>
  .bio-content {
    padding: 8px 0;
  }

  .bio-content :global(h1) {
    font-size: 24px;
    font-weight: 700;
    margin: 0 0 4px;
  }

  .bio-content :global(h2) {
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0 0 20px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(128, 128, 128, 0.3);
  }
  :global(.theme-dark) .bio-content :global(h2) { color: rgba(255, 255, 255, 0.5); }
  :global(.theme-light) .bio-content :global(h2) { color: rgba(0, 0, 0, 0.5); }

  .bio-content :global(h3) {
    font-size: 16px;
    font-weight: 600;
    margin: 24px 0 8px;
  }
  .bio-content :global(h3:first-of-type) {
    margin-top: 0;
  }

  .bio-content :global(p) {
    font-size: 15px;
    line-height: 1.6;
    margin: 0 0 12px;
  }
  :global(.theme-dark) .bio-content :global(p) { color: rgba(255, 255, 255, 0.8); }
  :global(.theme-light) .bio-content :global(p) { color: rgba(0, 0, 0, 0.8); }

  .bio-content :global(ul) {
    margin: 0 0 16px;
    padding-left: 20px;
  }
  .bio-content :global(li) {
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 4px;
  }
  :global(.theme-dark) .bio-content :global(li) { color: rgba(255, 255, 255, 0.8); }
  :global(.theme-light) .bio-content :global(li) { color: rgba(0, 0, 0, 0.8); }

  .bio-content :global(a) {
    color: #007AFF;
    text-decoration: none;
  }
  .bio-content :global(a:hover) { text-decoration: underline; }

  .bio-content :global(strong) {
    font-weight: 600;
  }
</style>
