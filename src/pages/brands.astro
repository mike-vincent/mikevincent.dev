---
import Base from '../layouts/Base.astro';

const brandSections = [
  {
    header: "Banking",
    items: [
      { name: "Capital One Databolt", url: "https://www.capitalone.com/software/products/databolt/", description: "Vaultless tokenization platform" },
    ],
  },
  {
    header: "Content Licensing & Distribution",
    items: [
      { name: "Io Pictures Corporation", url: "https://iopictures.com", description: "Motion picture distribution" },
    ],
  },
  {
    header: "Desktop Apps",
    items: [
      { name: "Timer Fantasy", url: "https://timerfantasy.com", description: "macOS timer with cloud sync" },
    ],
  },
  {
    header: "Defense",
    items: [
      { name: "Lockheed Martin", url: "https://www.lockheedmartin.com", description: "Intranet on headless Drupal" },
    ],
  },
  {
    header: "E-Commerce",
    items: [
      { name: "Canadian Tire", url: "https://www.canadiantire.ca", description: "E-commerce store" },
    ],
  },
  {
    header: "Fare Payments",
    items: [
      { name: "NextBus", url: "https://en.wikipedia.org/wiki/NextBus", description: "Migrated a legacy index system to a modern AWS ML pipeline as platform engineer" },
      { name: "DC Metro", url: "https://www.wmata.com", description: "Fare systems infrastructure" },
      { name: "NYC MTA", url: "https://new.mta.info", description: "Fare systems infrastructure" },
      { name: "BART", url: "https://www.bart.gov", description: "Fare systems infrastructure" },
      { name: "LA Metro", url: "https://www.metro.net", description: "Fare systems infrastructure" },
      { name: "Boston MBTA", url: "https://www.mbta.com", description: "Fare systems infrastructure" },
      { name: "SF Muni", url: "https://www.sfmta.com", description: "Fare systems infrastructure" },
      { name: "San Diego MTS", url: "https://www.sdmts.com", description: "Fare systems infrastructure" },
      { name: "PATCO", url: "https://www.ridepatco.org", description: "Fare systems infrastructure" },
    ],
  },
  {
    header: "Healthcare & Civic",
    items: [
      { name: "Poison Control", url: "https://www.poison.org", description: "Mobile app" },
      { name: "U.S. Conference of Catholic Bishops", url: "https://www.usccb.org", description: "Mobile app" },
    ],
  },
  {
    header: "Mobile Apps",
    items: [
      { name: "NY Fashion Week", url: "https://nyfw.com", description: "2015 mobile app" },
    ],
  },
  {
    header: "Mortgage Lending",
    items: [
      { name: "Fannie Mae Collateral Underwriter", url: "https://singlefamily.fanniemae.com/applications-technology/collateral-underwriter", description: "Mortgage appraisal tool" },
      { name: "HUD Capital Needs Assessment eTool", url: "https://www.hud.gov/hud-partners/multifamily-cna", description: "Public housing inspection platform" },
    ],
  },
  {
    header: "Networking",
    items: [
      { name: "LinkedIn", url: "https://www.linkedin.com/in/michael-thomas-vincent/", description: "Professional profile" },
    ],
  },
  {
    header: "Nonprofit",
    items: [
      { name: "The Archive of American Radio, Inc.", url: "https://archiveofamericanradio.org", description: "501(c)(3) preserving radio drama" },
    ],
  },
  {
    header: "Open Source",
    items: [
      { name: "InstaCart Order History Download", url: "https://github.com/mike-vincent/instacart-order-history-download", description: "Open-source CLI tool" },
    ],
  },
  {
    header: "Payments",
    items: [
      { name: "Zelle", url: "https://www.zellepay.com", description: "Peer-to-peer payments" },
    ],
  },
  {
    header: "Pre-2000 Websites",
    items: [
      { name: "wgshs.itgo.com", url: "http://wgshs.itgo.com", description: "Site of mine from the '90s" },
    ],
  },
  {
    header: "Writing",
    items: [
      { name: "Quark's Outlines", url: "https://dev.to/mike-vincent", description: "Python Deep Dives by Mike Vincent" },
    ],
  },
];

const brandAvatars: Record<string, string> = {
  'Timer Fantasy': '/assets/brands/timerfantasy-icon.png',
  'Io Pictures Corporation': '/assets/brands/iopictures-io-icon-v2.png',
  'The Archive of American Radio, Inc.': '/assets/brands/archive-icon.svg',
};

const brandInitialOverrides: Record<string, string> = {
  NextBus: 'NB',
  'NYC MTA': 'NY',
  'Boston MBTA': 'MB',
  'LA Metro': 'LA',
  'SF Muni': 'SF',
  'wgshs.itgo.com': 'WG',
  "Quark's Outlines": 'Q',
};

const getBrandInitials = (name: string): string => {
  const override = brandInitialOverrides[name];
  if (override) return override;
  const words = name
    .replace(/[^A-Za-z0-9 ]+/g, ' ')
    .trim()
    .split(/\s+/)
    .filter(Boolean);
  if (words.length === 0) return '?';
  if (words.length === 1) return words[0].slice(0, 2).toUpperCase();
  return `${words[0][0]}${words[1][0]}`.toUpperCase();
};

const truncateSubhead = (text: string): string => {
  const clean = text.trim();
  if (clean.length <= 16) return clean;
  return `${clean.slice(0, 15).trimEnd()}â€¦`;
};

const brands = brandSections
  .flatMap((section) => section.items)
  .slice()
  .sort((a, b) => a.name.localeCompare(b.name, 'en', { sensitivity: 'base' }));
---

<Base title="Projects - Mike Vincent" description="Projects by Mike Vincent">
  <section class="brands-list-wrap">
    <ul class="brands-list">
      {brands.map((brand) => {
        const avatarSrc = brandAvatars[brand.name];
        const initials = getBrandInitials(brand.name);
        return (
          <li>
            {brand.url ? (
              <a class="venture-main-link" href={brand.url} target="_blank" rel="noopener noreferrer">
                <span class={`venture-thumb ${avatarSrc ? 'venture-thumb--image' : 'venture-thumb--fallback-shell'}`} aria-hidden="true">
                  {avatarSrc ? (
                    <img class="venture-thumb-image" src={avatarSrc} alt="" loading="lazy" decoding="async" />
                  ) : (
                    <span class="venture-thumb-fallback">{initials}</span>
                  )}
                </span>
                <span class="venture-lines">
                  <span class="brand-name">{brand.name}</span>
                  <span class="venture-subtitle">{truncateSubhead(brand.description)}</span>
                </span>
              </a>
            ) : (
              <span class="venture-main-link brand-link-none">
                <span class={`venture-thumb ${avatarSrc ? 'venture-thumb--image' : 'venture-thumb--fallback-shell'}`} aria-hidden="true">
                  {avatarSrc ? (
                    <img class="venture-thumb-image" src={avatarSrc} alt="" loading="lazy" decoding="async" />
                  ) : (
                    <span class="venture-thumb-fallback">{initials}</span>
                  )}
                </span>
                <span class="venture-lines">
                  <span class="brand-name">{brand.name}</span>
                  <span class="venture-subtitle">{truncateSubhead(brand.description)}</span>
                </span>
              </span>
            )}
          </li>
        );
      })}
    </ul>
  </section>
</Base>

<style>
  :global(.page-content):has(.brands-list-wrap) {
    padding-top: 0;
    padding-bottom: 0;
  }
  .brands-list-wrap {
    margin-left: -11px;
    margin-right: -11px;
    padding: 0 11px 8px;
  }
  .brands-list {
    list-style: none;
    margin: 0;
    padding: 0;
  }
  .brands-list li {
    border-top: 1px solid rgba(128, 128, 128, 0.2);
  }
  .brands-list li:first-child {
    border-top: none;
  }

  .venture-main-link {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 0;
    text-decoration: none;
  }
  .venture-main-link,
  .venture-main-link:visited {
    color: inherit;
  }
  .venture-main-link:hover {
    text-decoration: none;
  }
  .brand-link-none {
    cursor: default;
  }

  .venture-thumb {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    overflow: hidden;
    flex: 0 0 auto;
  }
  .venture-thumb {
    width: 36px;
    height: 36px;
    border-radius: 999px;
  }
  .venture-thumb--image {
    padding: 4px;
    border: 1px solid rgba(128, 128, 128, 0.25);
  }
  :global(.theme-dark) .venture-thumb--image {
    background: rgba(255, 255, 255, 0.92);
  }
  :global(.theme-light) .venture-thumb--image {
    background: rgba(0, 0, 0, 0.04);
  }
  .venture-thumb--fallback-shell {
    padding: 0;
    border: none;
  }
  :global(.theme-dark) .venture-thumb--fallback-shell {
    background: rgba(255, 255, 255, 0.15);
    color: var(--mv-text-dark-primary);
  }
  :global(.theme-light) .venture-thumb--fallback-shell {
    background: rgba(0, 0, 0, 0.1);
    color: var(--mv-text-light-primary);
  }
  :global(.theme-dark) .venture-main-link:hover .venture-thumb--fallback-shell {
    background: rgba(255, 255, 255, 0.25);
  }
  :global(.theme-light) .venture-main-link:hover .venture-thumb--fallback-shell {
    background: rgba(0, 0, 0, 0.16);
  }
  .venture-thumb-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
  }
  .venture-thumb-fallback {
    width: 100%;
    height: 100%;
    border-radius: 999px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: var(--mv-size-regular);
    font-weight: var(--mv-weight-strong);
    line-height: 1;
    letter-spacing: 0.2px;
    background: transparent;
    color: inherit;
  }

  .venture-lines {
    min-width: 0;
    display: grid;
    gap: 1px;
  }

  .brands-list a:hover .brand-name,
  .brands-list a:hover .venture-subtitle {
    text-decoration: none;
  }

  .brand-name {
    font-size: var(--mv-size-regular);
    font-weight: var(--mv-weight-regular);
    line-height: 1.2;
  }
  :global(.theme-dark) .brand-name { color: var(--mv-text-dark-primary); }
  :global(.theme-light) .brand-name { color: var(--mv-text-light-primary); }
  .venture-subtitle {
    font-size: var(--mv-size-regular);
    font-weight: var(--mv-weight-regular);
    line-height: 1.2;
    opacity: var(--mv-opacity-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  :global(.theme-dark) .venture-subtitle { color: var(--mv-text-dark-secondary); }
  :global(.theme-light) .venture-subtitle { color: var(--mv-text-light-secondary); }
</style>
